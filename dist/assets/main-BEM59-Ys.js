import{c as q,g as L,d as O,a as Y,b as v,o as A,q as E,e as H,w as $,T as F,f as N}from"./style-BsFD9vxn.js";import{t as g,n as b,g as T,a as U,e as z,m as I,b as y}from"./en-US-D39Fpcz1.js";/* empty css            */function R(t,n){let e=t,r=n;const s=q(v,"chats");let c=null;const u=async f=>{const a=new Date,i={username:r,room:e,message:f,created_at:F.fromDate(a)};try{return await N(s,i)}catch(l){throw console.log(l),l}},o=f=>{c&&c(),c=A(E(s,$("room","==",e),H("created_at")),a=>{a.docChanges().forEach(i=>{i.type==="added"&&f(i.doc.data())})})},m=f=>{e=f},d=f=>{r=f,localStorage.setItem("username",r)};return(()=>{let f=setInterval(async()=>{try{const a=await L(s);if(a.empty)return console.log("No message to delete"),clearInterval(f),!0;a.forEach(async i=>{await O(Y(v,"chats",i.id))}),console.log("All message deleted successfully")}catch(a){console.error("Error deleting message : ",a)}},15e3)})(),{addChat:u,getChats:o,updateChatroom:m,updateUsername:d}}function p(t,n){const e=+g(t)-+g(n);return e<0?-1:e>0?1:e}function j(t,n,e){const[r,s]=b(e?.in,t,n),c=r.getFullYear()-s.getFullYear(),u=r.getMonth()-s.getMonth();return c*12+u}function k(t){return n=>{const r=(t?Math[t]:Math.trunc)(n);return r===0?0:r}}function G(t,n){return+g(t)-+g(n)}function B(t,n){const e=g(t,n?.in);return e.setHours(23,59,59,999),e}function J(t,n){const e=g(t,n?.in),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function K(t,n){const e=g(t,n?.in);return+B(e,n)==+J(e,n)}function P(t,n,e){const[r,s,c]=b(e?.in,t,t,n),u=p(s,c),o=Math.abs(j(s,c));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-u*o);let m=p(s,c)===-u;K(r)&&o===1&&p(r,c)===1&&(m=!1);const d=u*(o-+m);return d===0?0:d}function Q(t,n,e){const r=G(t,n)/1e3;return k(e?.roundingMethod)(r)}function V(t,n,e){const r=U(),s=e?.locale??r.locale??z,c=2520,u=p(t,n);if(isNaN(u))throw new RangeError("Invalid time value");const o=Object.assign({},e,{addSuffix:e?.addSuffix,comparison:u}),[m,d]=b(e?.in,...u>0?[n,t]:[t,n]),h=Q(d,m),f=(T(d)-T(m))/1e3,a=Math.round((h-f)/60);let i;if(a<2)return e?.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,o):h<10?s.formatDistance("lessThanXSeconds",10,o):h<20?s.formatDistance("lessThanXSeconds",20,o):h<40?s.formatDistance("halfAMinute",0,o):h<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):a===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",a,o);if(a<45)return s.formatDistance("xMinutes",a,o);if(a<90)return s.formatDistance("aboutXHours",1,o);if(a<I){const l=Math.round(a/60);return s.formatDistance("aboutXHours",l,o)}else{if(a<c)return s.formatDistance("xDays",1,o);if(a<y){const l=Math.round(a/I);return s.formatDistance("xDays",l,o)}else if(a<y*2)return i=Math.round(a/y),s.formatDistance("aboutXMonths",i,o)}if(i=P(d,m),i<12){const l=Math.round(a/y);return s.formatDistance("xMonths",l,o)}else{const l=i%12,S=Math.trunc(i/12);return l<3?s.formatDistance("aboutXYears",S,o):l<9?s.formatDistance("overXYears",S,o):s.formatDistance("almostXYears",S+1,o)}}function W(t){return{newli:r=>{const s=V(r.created_at.toDate(),new Date,{addSuffix:!0}),c=`
                        <li class="shadow rounded-lg px-4 py-2">
                            <div class="flex justify-between">
                                <h5 class="text-gray-600 font-medium text-sm">${r.username}</h5>
                                <i class="text-gray-300 tet-sm-xs">${s}</i>
                            </div>
                            <p class="text-gray-600 text-sm">${r.message}</p>
                        </li>

                    `;t.innerHTML+=c},resetli:()=>{t.innerHTML=""}}}const Z=document.querySelector(".chatrooms"),ee=document.querySelector(".chat-ul"),x=document.querySelector(".chat-form"),D=document.querySelector(".user-form"),C=document.querySelector(".msg"),_=document.querySelector(".roomtitle"),X=localStorage.username?localStorage.username:"Guest";D.username.placeholder=`username is ${X}`;const M=R("general",X);_.textContent="General";const w=W(ee);x.addEventListener("submit",t=>{t.preventDefault();const n=x.message.value.trim();M.addChat(n).then(()=>x.reset()).catch(e=>console.log(e))});D.addEventListener("submit",t=>{t.preventDefault();const n=D.username.value.trim();M.updateUsername(n),D.reset(),C.innerText=`Username is updated to ${n}`,D.username.placeholder=`username is ${n}`,setTimeout(()=>C.innerText,3e3)});Z.addEventListener("click",t=>{t.preventDefault();const n=t.target.closest("button");if(console.log(n),n){w.resetli();const e=n.getAttribute("id"),r=n.querySelector("h3").innerText;_.textContent=r,M.updateChatroom(e)}M.getChats(e=>{w.newli(e)})});M.getChats(t=>{w.newli(t)});
