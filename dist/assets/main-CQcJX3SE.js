import{c as X,o as q,q as L,a as O,w as Y,T as H,b as $,d as E}from"./style-7D2Cdk3K.js";import{t as h,n as b,g as C,a as F,e as U,m as T,b as y}from"./en-US-CA2fCWl0.js";/* empty css            */function A(t,n){let e=t,r=n;const s=X(E,"chats");let c=null;return{addChat:async i=>{const g=new Date,a={username:r,room:e,message:i,created_at:H.fromDate(g)};try{return await $(s,a)}catch(l){throw console.log(l),l}},getChats:i=>{c&&c(),c=q(L(s,Y("room","==",e),O("created_at")),g=>{g.docChanges().forEach(a=>{a.type==="added"&&i(a.doc.data())})})},updateChatroom:i=>{e=i},updateUsername:i=>{r=i,localStorage.setItem("username",r)}}}function p(t,n){const e=+h(t)-+h(n);return e<0?-1:e>0?1:e}function z(t,n,e){const[r,s]=b(e?.in,t,n),c=r.getFullYear()-s.getFullYear(),u=r.getMonth()-s.getMonth();return c*12+u}function N(t){return n=>{const r=(t?Math[t]:Math.trunc)(n);return r===0?0:r}}function R(t,n){return+h(t)-+h(n)}function j(t,n){const e=h(t,n?.in);return e.setHours(23,59,59,999),e}function k(t,n){const e=h(t,n?.in),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function G(t,n){const e=h(t,n?.in);return+j(e,n)==+k(e,n)}function B(t,n,e){const[r,s,c]=b(e?.in,t,t,n),u=p(s,c),o=Math.abs(z(s,c));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-u*o);let m=p(s,c)===-u;G(r)&&o===1&&p(r,c)===1&&(m=!1);const d=u*(o-+m);return d===0?0:d}function J(t,n,e){const r=R(t,n)/1e3;return N(e?.roundingMethod)(r)}function K(t,n,e){const r=F(),s=e?.locale??r.locale??U,c=2520,u=p(t,n);if(isNaN(u))throw new RangeError("Invalid time value");const o=Object.assign({},e,{addSuffix:e?.addSuffix,comparison:u}),[m,d]=b(e?.in,...u>0?[n,t]:[t,n]),i=J(d,m),g=(C(d)-C(m))/1e3,a=Math.round((i-g)/60);let l;if(a<2)return e?.includeSeconds?i<5?s.formatDistance("lessThanXSeconds",5,o):i<10?s.formatDistance("lessThanXSeconds",10,o):i<20?s.formatDistance("lessThanXSeconds",20,o):i<40?s.formatDistance("halfAMinute",0,o):i<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):a===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",a,o);if(a<45)return s.formatDistance("xMinutes",a,o);if(a<90)return s.formatDistance("aboutXHours",1,o);if(a<T){const f=Math.round(a/60);return s.formatDistance("aboutXHours",f,o)}else{if(a<c)return s.formatDistance("xDays",1,o);if(a<y){const f=Math.round(a/T);return s.formatDistance("xDays",f,o)}else if(a<y*2)return l=Math.round(a/y),s.formatDistance("aboutXMonths",l,o)}if(l=B(d,m),l<12){const f=Math.round(a/y);return s.formatDistance("xMonths",f,o)}else{const f=l%12,S=Math.trunc(l/12);return f<3?s.formatDistance("aboutXYears",S,o):f<9?s.formatDistance("overXYears",S,o):s.formatDistance("almostXYears",S+1,o)}}function P(t){return{newli:r=>{const s=K(r.created_at.toDate(),new Date,{addSuffix:!0}),c=`
                        <li class="shadow rounded-lg px-4 py-2">
                            <div class="flex justify-between">
                                <h5 class="text-gray-600 font-medium text-sm">${r.username}</h5>
                                <i class="text-gray-300 tet-sm-xs">${s}</i>
                            </div>
                            <p class="text-gray-600 text-sm">${r.message}</p>
                        </li>

                    `;t.innerHTML+=c},resetli:()=>{t.innerHTML=""}}}const Q=document.querySelector(".chatrooms"),V=document.querySelector(".chat-ul"),x=document.querySelector(".chat-form"),D=document.querySelector(".user-form"),v=document.querySelector(".msg"),_=document.querySelector(".roomtitle"),I=localStorage.username?localStorage.username:"Guest";D.username.placeholder=`username is ${I}`;const M=A("general",I);_.textContent="General";const w=P(V);x.addEventListener("submit",t=>{t.preventDefault();const n=x.message.value.trim();M.addChat(n).then(()=>x.reset()).catch(e=>console.log(e))});D.addEventListener("submit",t=>{t.preventDefault();const n=D.username.value.trim();M.updateUsername(n),D.reset(),v.innerText=`Username is updated to ${n}`,D.username.placeholder=`username is ${n}`,setTimeout(()=>v.innerText,3e3)});Q.addEventListener("click",t=>{t.preventDefault();const n=t.target.closest("button");if(console.log(n),n){w.resetli();const e=n.getAttribute("id"),r=n.querySelector("h3").innerText;_.textContent=r,M.updateChatroom(e)}M.getChats(e=>{w.newli(e)})});M.getChats(t=>{w.newli(t)});
